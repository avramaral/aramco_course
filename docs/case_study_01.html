<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="André Victor Ribeiro Amaral" />


<title>Case Study 01</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Exercises in Linear Models</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="case_study_01.html">Case Study 01</a>
</li>
<li>
  <a href="case_study_02.html">Case Study 02</a>
</li>
<li>
  <a href="case_study_03.html">Case Study 03</a>
</li>
<li>
  <a href="case_study_04.html">Case Study 04</a>
</li>
<li>
  <a href="case_study_05.html">Case Study 05</a>
</li>
<li>
  <a href="case_study_06.html">Case Study 06</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://avramaral.github.io/">
    <span class="fa fa-globe"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Case Study 01</h1>
<h4 class="author">André Victor Ribeiro Amaral</h4>

</div>


<div id="objectives" class="section level1 unnumbered">
<h1 class="unnumbered">Objectives</h1>
<p>In this case study, we will fit a One-way ANOVA model, meaning that our dependent variable will be written as a function of one categorical regressor. The objective here will be checking whether the treatment has an effect on the response variable. To do this, we will fit the model, check the assumptions, interpret it, and predict new values based on this fitted model.</p>
</div>
<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>For this problem, we will analyse data about the the tensile strength of Portland cement. Four different mixing techniques were tested and the resulting tensile strength was measured. You can download the <code>.csv</code> file <a href="./datasets/tesile_strength.csv">here</a>.</p>
<p>This data set contains following the variables:</p>
<ol style="list-style-type: decimal">
<li><code>mixingType</code> (multi-valued discrete)</li>
<li><code>strength</code> (continuous)</li>
</ol>
</div>
<div id="exploring-the-data-set" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Exploring the data set</h1>
<p>In order to explore the data set and perform initial analyses, we have to read it (with <code>R</code>) first. Provided that the <code>.csv</code> file is saved within the <code>datasets/</code> folder, one can read the file in the following way.</p>
<pre class="r"><code>col.names &lt;- c(&#39;mixingType&#39;, &#39;strength&#39;)
ts &lt;- read.csv(file = &#39;datasets/tensile_strength.csv&#39;, header = FALSE, sep = &#39;,&#39;, col.names = col.names)
head(ts, 5)</code></pre>
<pre><code>##   mixingType strength
## 1          A     3129
## 2          A     3000
## 3          A     2865
## 4          A     2890
## 5          B     3200</code></pre>
<p>Now, let’s see a summary of our data.</p>
<pre class="r"><code>summary(ts)</code></pre>
<pre><code>##   mixingType           strength   
##  Length:16          Min.   :2600  
##  Class :character   1st Qu.:2791  
##  Mode  :character   Median :2938  
##                     Mean   :2932  
##                     3rd Qu.:3070  
##                     Max.   :3300</code></pre>
<p>As one can see from the above table, the multi-valued discrete attribute is being interpreted as character; however, we should set is as factor. For changing it, we can do the following</p>
<pre class="r"><code>ts$mixingType &lt;- as.factor(ts$mixingType)
summary(ts)</code></pre>
<pre><code>##  mixingType    strength   
##  A:4        Min.   :2600  
##  B:4        1st Qu.:2791  
##  C:4        Median :2938  
##  D:4        Mean   :2932  
##             3rd Qu.:3070  
##             Max.   :3300</code></pre>
<p>As a way to first start exploring the data, we can do a boxplots for <code>strength</code> as a function of the <code>mixingType</code>, so that we can observe whether the mixing type has an effect on the strength.</p>
<pre class="r"><code>boxplot(strength ~ mixingType, data = ts)</code></pre>
<p><img src="case_study_01_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>First thing to observe is the fact that the boxes have (approximately) the same height, which supports the assumption of equal variances. Also, especially when one focus on groups <code>B</code> and <code>D</code>, one can see a clear difference between treatments, which may suggest that the mixing type has effect on the strength. However, we still have to fit a model and perform the appropriate analyses before concluding anything.</p>
</div>
<div id="fitting-a-model" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Fitting a model</h1>
<p>So let’s start by fitting a linear model for <code>strength</code> as a function of <code>mixingType</code>. We can do this using the <code>lm()</code> function, from <code>base R</code>.</p>
<pre class="r"><code>model &lt;- lm(formula = strength ~ mixingType, data = ts)</code></pre>
<p>However, in this case, we are interested in the ANOVA table. To get it, we can use the <code>anova()</code> function for a object returned from the <code>lm()</code> method, as <code>model</code>. Alternatively, we could have used the <code>aov(formula = strength ~ mixingType, data = ts)</code> command.</p>
<pre class="r"><code>anova(model)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: strength
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## mixingType  3 489740  163247  12.728 0.0004887 ***
## Residuals  12 153908   12826                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>From the above table, we can see that the p-value (= 0.0004887) is very small, so we reject the null hypothesis that says that all means are the same. Which is the same as saying that there is evidence from the data that the mixing type has an effect on the strength (<strong>if we have a valid model</strong>; we will check it).</p>
<p>Additionally, we can also compute the estimated means for the for the four mixing types, namely <span class="math inline">\(\hat{\mu} + \hat{\tau}_i\)</span>, <span class="math inline">\(\forall i\)</span>. To do this, we can use the <code>model.tables()</code> function.</p>
<pre class="r"><code># Average values
modAOV &lt;- aov(formula = strength ~ mixingType, data = ts)
model.tables(modAOV, &#39;means&#39;)</code></pre>
<pre><code>## Tables of means
## Grand mean
##          
## 2931.812 
## 
##  mixingType 
## mixingType
##      A      B      C      D 
## 2971.0 3156.2 2933.8 2666.2</code></pre>
<pre class="r"><code># Effects
model.tables(modAOV)</code></pre>
<pre><code>## Tables of effects
## 
##  mixingType 
## mixingType
##       A       B       C       D 
##   39.19  224.44    1.94 -265.56</code></pre>
<p>Notice that, by analyzing <code>summary(model)</code> this is the same as</p>
<pre class="r"><code>summary(model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = strength ~ mixingType, data = ts)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -181.25  -69.94   11.38   63.12  158.00 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2971.00      56.63  52.468 1.51e-15 ***
## mixingTypeB   185.25      80.08   2.313   0.0392 *  
## mixingTypeC   -37.25      80.08  -0.465   0.6501    
## mixingTypeD  -304.75      80.08  -3.806   0.0025 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 113.3 on 12 degrees of freedom
## Multiple R-squared:  0.7609, Adjusted R-squared:  0.7011 
## F-statistic: 12.73 on 3 and 12 DF,  p-value: 0.0004887</code></pre>
<pre class="r"><code>data.frame(Treatments = c(&#39;mu+tau_1&#39;, &#39;mu+tau_2&#39;, &#39;mu+tau_3&#39;, &#39;mu+tau_4&#39;),
           Average    = model$coefficients[1] + c(0, model$coefficients[2:4]),
           row.names  = c(&#39;mixtechA&#39;, names(model$coefficients)[2:4]))</code></pre>
<pre><code>##             Treatments Average
## mixtechA      mu+tau_1 2971.00
## mixingTypeB   mu+tau_2 3156.25
## mixingTypeC   mu+tau_3 2933.75
## mixingTypeD   mu+tau_4 2666.25</code></pre>
<pre class="r"><code>data.frame(Treatments = c(&#39;tau_1&#39;, &#39;tau_2&#39;, &#39;tau_3&#39;, &#39;tau_4&#39;),
           Effect     = model$coefficients[1] + c(0, model$coefficients[2:4]) - mean(ts$strength),
           row.names  = c(&#39;mixtechA&#39;, names(model$coefficients)[2:4])) # Subtracting the mean</code></pre>
<pre><code>##             Treatments    Effect
## mixtechA         tau_1   39.1875
## mixingTypeB      tau_2  224.4375
## mixingTypeC      tau_3    1.9375
## mixingTypeD      tau_4 -265.5625</code></pre>
<p>Now, we will do one the most important steps, namely “residual analysis”. It is crucial to verify whether the model assumptions hold. In this case, we will test for equal variance and normality for the residuals. We can do this graphically as follows</p>
<pre class="r"><code>plot(model, which = c(1, 2))</code></pre>
<p><img src="case_study_01_files/figure-html/unnamed-chunk-9-1.png" width="672" /><img src="case_study_01_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<p>Both plots look okay, since points are equally dispersed around <span class="math inline">\(y = 0\)</span> for the “Residuals vs. Fitted” graph, and the values lie along the line (meaning the data distribution has the same shape as the theoretical distribution we have supposed; i.e., Normal) for the “Normal Q-Q” graph. However, to confirm this visual interpretation of the plots, we can perform a test for both assumption. To do this, we will use the Score Test, available in the <code>car</code> package through the <code>leveneTest()</code> function. Also, to check for the normality of the residuals, we will use the Shapiro-Wilk test (<code>shapiro.test()</code>).</p>
<pre class="r"><code>library(&#39;car&#39;)</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre class="r"><code>leveneTest(model)</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  3  0.1833 0.9057
##       12</code></pre>
<pre class="r"><code>shapiro.test(resid(model))</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  resid(model)
## W = 0.97046, p-value = 0.846</code></pre>
<p>Since the p-values are large for both tests, we fail to reject the hypothesis of equal variance and normality, meaning that assumptions hold.</p>
<p>Finally, we can also do a pairwise comparison among the treatments. In this case, we will use the Tukey’s Honest Significant Difference method. For a 95% confidence level, and using the <code>TukeyHSD()</code> function,</p>
<pre class="r"><code>(modTuk &lt;- TukeyHSD(modAOV))</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = strength ~ mixingType, data = ts)
## 
## $mixingType
##        diff        lwr        upr     p adj
## B-A  185.25  -52.50029  423.00029 0.1493561
## C-A  -37.25 -275.00029  200.50029 0.9652776
## D-A -304.75 -542.50029  -66.99971 0.0115923
## C-B -222.50 -460.25029   15.25029 0.0693027
## D-B -490.00 -727.75029 -252.24971 0.0002622
## D-C -267.50 -505.25029  -29.74971 0.0261838</code></pre>
<pre class="r"><code>plot(modTuk)</code></pre>
<p><img src="case_study_01_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>As we can see from the table and the plot, we fail to reject that the means for the pairs <code>B-A</code>, <code>C-A</code>, and <code>C-B</code> are different, but we reject the null hypothesis for the pairs <code>D-A</code>, <code>D-B</code>, and <code>D-C</code>. Meaning that mixing type <code>D</code> is different from the rest, but the others cannot be distinguished.</p>
<p>So the question is, <strong>if you had to choose a mixing type, which one would you pick?</strong></p>
</div>
<div id="predicting-unknown-values" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Predicting unknown values</h1>
<p>As expected, the predicted values for each group will be equal to the estimated means (as computed above). To see this, we can use the <code>predict()</code> function.</p>
<pre class="r"><code>newdata &lt;- data.frame(mixingType = factor(c(&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;)))
predict(model, newdata = newdata)</code></pre>
<pre><code>##       1       2       3       4 
## 2971.00 3156.25 2933.75 2666.25</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
