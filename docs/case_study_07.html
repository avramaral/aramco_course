<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="André Victor Ribeiro Amaral" />


<title>Case Study 07</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Linear Models</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="case_study_01.html">Case Study 01</a>
</li>
<li>
  <a href="case_study_02.html">Case Study 02</a>
</li>
<li>
  <a href="case_study_03.html">Case Study 03</a>
</li>
<li>
  <a href="case_study_04.html">Case Study 04</a>
</li>
<li>
  <a href="case_study_05.html">Case Study 05</a>
</li>
<li>
  <a href="case_study_06.html">Case Study 06</a>
</li>
<li>
  <a href="case_study_07.html">Case Study 07</a>
</li>
<li>
  <a href="case_study_08.html">Case Study 08</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://avramaral.github.io/">
    <span class="fa fa-globe"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Case Study 07</h1>
<h4 class="author">André Victor Ribeiro Amaral</h4>

</div>


<div id="objectives" class="section level1 unnumbered">
<h1 class="unnumbered">Objectives</h1>
<p>As <a href="./case_study_06.html">before</a>, in this case study, we will fit a logistic regression model. However, this time we will be concerning in using logistic regression for a classification problem. To do this, we will fit and interpret the model, but we will also use it to predict the class of a newly observed cases. Moreover, to select an appropriate threshold for classifying new cases, we will deal with the Receiver Operating Characteristic (ROC) curve.</p>
</div>
<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>For this problem, we will analyse data about office workers’ performance. The objective is classifying them as <code>1</code>, if they deserve to be promoted, and <code>0</code>, otherwise. The data set was retrieved from <a href="https://datahack.analyticsvidhya.com/contest/wns-analytics-hackathon-2018-1/">this page</a> (with changes). You can download the <code>.csv</code> file <a href="./datasets/hr.csv">here</a>.</p>
<p>This data set contains the following variables:</p>
<ol style="list-style-type: decimal">
<li><code>gender</code> (categorical): female (F) or male (M)</li>
<li><code>no_of_courses</code> (numeric): number of courses completed in the previous year</li>
<li><code>age</code> (numeric)</li>
<li><code>previous_year_rating</code> (numeric): employee rating for the previous year</li>
<li><code>length_of_service</code> (numeric): length of service in years</li>
<li><code>KPIs_met_greater_80</code> (categorical): if percent of Key Performance Indicators (KPIs) is greater than 80%, then <code>1</code>; otherwise, <code>0</code></li>
<li><code>awards_won</code> (categorical): if won an award during the previous year, then <code>1</code>; otherwise, <code>0</code></li>
<li><code>avg_training_score</code> (numeric): average score in current training evaluation</li>
<li><code>is_promoted</code> (categorical): recommended for promotion</li>
</ol>
<div id="logistic-regression-for-classification" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Logistic Regression for Classification</h2>
<p>Since the output of a logistic model is a probability <span class="math inline">\(\theta\)</span> that represents the conditional probability that the variable <span class="math inline">\(Y\)</span> is equal to 1 given the value of the covariates <span class="math inline">\(\mathbf{X}\)</span>, we can use this probability to, given a threshold <span class="math inline">\(\theta_0\)</span>, classify <span class="math inline">\(\mathbf{X} = \mathbf{x}_0\)</span> as <code>1</code>, if <span class="math inline">\(\hat{\theta}(\mathbf{x}_0) &gt; \theta_0\)</span>, and <code>0</code>, otherwise.</p>
<p>In this sense, one important tool we will use is named <strong>Confusion Matrix</strong>. For instance, we may have</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Predicted <code>0</code></th>
<th>Predicted <code>1</code></th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Observed</strong> <code>0</code></td>
<td>40</td>
<td>20</td>
<td><strong>60</strong></td>
</tr>
<tr class="even">
<td><strong>Observed</strong> <code>1</code></td>
<td>15</td>
<td>50</td>
<td><strong>65</strong></td>
</tr>
<tr class="odd">
<td><strong>Total</strong></td>
<td><strong>55</strong></td>
<td><strong>70</strong></td>
<td><strong>125</strong></td>
</tr>
</tbody>
</table>
<p>From the above table, we are interested in the following quantities</p>
<ul>
<li><strong>True positives (TP)</strong>: model predict <code>1</code> and the values were actually <code>1</code> (e.g, 50).</li>
<li><strong>True negatives (TN)</strong>: model predict <code>0</code> and the values were actually <code>0</code> (e.g, 40).</li>
<li><strong>False positives (FP)</strong>: model predict <code>1</code> and the values were actually <code>0</code> (e.g, 20).</li>
<li><strong>False negatives (FN)</strong>: model predict <code>0</code> and the values were actually <code>1</code> (e.g, 15).</li>
</ul>
<p>Also, and based on these quantities, we can determine the <span class="math inline">\(\texttt{accuracy}\)</span>in the following way</p>
<p><span class="math display">\[
\texttt{accuracy} = \frac{\texttt{TP} + \texttt{TN}}{\texttt{total}},
\]</span> which describes how often the classifier is correct. In our example, <span class="math inline">\(\texttt{accuracy} = 90/125 = 0.72\)</span>.</p>
<p>Other measures of accuracy include</p>
<ul>
<li><strong>Sensitivity</strong>: when the true result is <code>1</code>, how often the model predicts <code>1</code>? (<span class="math inline">\(\texttt{TP}/(\texttt{TP} + \texttt{FN})\)</span>)</li>
<li><strong>Specificity</strong>: when the true result is <code>0</code>, how often the model predicts <code>0</code>? (<span class="math inline">\(\texttt{TN}/(\texttt{TN} + \texttt{FP})\)</span>)</li>
</ul>
</div>
</div>
<div id="exploring-the-data-set" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Exploring the data set</h1>
<p>In order to explore the data set and perform initial analyses, we have to read it (with <code>R</code>) first. Provided that the <code>.csv</code> file is saved within the <code>datasets/</code> folder, one can read the file in the following way.</p>
<pre class="r"><code>col.names &lt;- c(&#39;gender&#39;, &#39;no_of_courses&#39;, &#39;age&#39;, &#39;previous_year_rating&#39;, &#39;length_of_service&#39;, &#39;KPIs_met_greater_80&#39;, &#39;awards_won&#39;, &#39;avg_training_score&#39;, &#39;is_promoted&#39;)
hr &lt;- read.csv(file = &#39;datasets/hr.csv&#39;, header = FALSE, sep = &#39;,&#39;, col.names = col.names)
head(hr, 5)</code></pre>
<pre><code>##   gender no_of_courses age previous_year_rating length_of_service
## 1      F             1  35                    5                 8
## 2      M             1  30                    5                 4
## 3      M             1  34                    3                 7
## 4      M             2  39                    1                10
## 5      M             1  45                    3                 2
##   KPIs_met_greater_80 awards_won avg_training_score is_promoted
## 1                   1          0                 49           0
## 2                   0          0                 60           0
## 3                   0          0                 50           0
## 4                   0          0                 50           0
## 5                   0          0                 73           0</code></pre>
<p>Now, let’s see a summary of our data.</p>
<pre class="r"><code>summary(hr)</code></pre>
<pre><code>##     gender          no_of_courses         age        previous_year_rating
##  Length:50684       Min.   : 1.000   Min.   :20.00   Min.   :1.000       
##  Class :character   1st Qu.: 1.000   1st Qu.:30.00   1st Qu.:3.000       
##  Mode  :character   Median : 1.000   Median :34.00   Median :3.000       
##                     Mean   : 1.248   Mean   :35.45   Mean   :3.329       
##                     3rd Qu.: 1.000   3rd Qu.:39.00   3rd Qu.:4.000       
##                     Max.   :10.000   Max.   :60.00   Max.   :5.000       
##  length_of_service KPIs_met_greater_80   awards_won      avg_training_score
##  Min.   : 1.000    Min.   :0.0000      Min.   :0.00000   Min.   :39.00     
##  1st Qu.: 3.000    1st Qu.:0.0000      1st Qu.:0.00000   1st Qu.:51.00     
##  Median : 5.000    Median :0.0000      Median :0.00000   Median :60.00     
##  Mean   : 6.261    Mean   :0.3522      Mean   :0.02316   Mean   :63.39     
##  3rd Qu.: 8.000    3rd Qu.:1.0000      3rd Qu.:0.00000   3rd Qu.:76.00     
##  Max.   :37.000    Max.   :1.0000      Max.   :1.00000   Max.   :99.00     
##   is_promoted     
##  Min.   :0.00000  
##  1st Qu.:0.00000  
##  Median :0.00000  
##  Mean   :0.08541  
##  3rd Qu.:0.00000  
##  Max.   :1.00000</code></pre>
<p>However, as some variables are being interpreted as numeric, we have to convert them to factor (categorical variable) before conducting any analysis.</p>
<pre class="r"><code>hr$gender &lt;- factor(hr$gender)
hr$KPIs_met_greater_80 &lt;- factor(hr$KPIs_met_greater_80)
hr$awards_won &lt;- factor(hr$awards_won)
hr$is_promoted &lt;- factor(hr$is_promoted)
summary(hr)</code></pre>
<pre><code>##  gender    no_of_courses         age        previous_year_rating
##  F:15154   Min.   : 1.000   Min.   :20.00   Min.   :1.000       
##  M:35530   1st Qu.: 1.000   1st Qu.:30.00   1st Qu.:3.000       
##            Median : 1.000   Median :34.00   Median :3.000       
##            Mean   : 1.248   Mean   :35.45   Mean   :3.329       
##            3rd Qu.: 1.000   3rd Qu.:39.00   3rd Qu.:4.000       
##            Max.   :10.000   Max.   :60.00   Max.   :5.000       
##  length_of_service KPIs_met_greater_80 awards_won avg_training_score
##  Min.   : 1.000    0:32835             0:49510    Min.   :39.00     
##  1st Qu.: 3.000    1:17849             1: 1174    1st Qu.:51.00     
##  Median : 5.000                                   Median :60.00     
##  Mean   : 6.261                                   Mean   :63.39     
##  3rd Qu.: 8.000                                   3rd Qu.:76.00     
##  Max.   :37.000                                   Max.   :99.00     
##  is_promoted
##  0:46355    
##  1: 4329    
##             
##             
##             
## </code></pre>
<p>Now, we can fit our model.</p>
</div>
<div id="fitting-a-model" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Fitting a model</h1>
<p>However, before fitting our model, we will split our data into <code>training</code> and <code>testing</code> data sets. To do this, we can use the <code>sample.split()</code> function from the <code>caTools</code> package.</p>
<pre class="r"><code>library(&#39;caTools&#39;)
set.seed(1)
split &lt;- sample.split(hr$is_promoted, SplitRatio = 0.75)

hrTraining &lt;- subset(hr, split == TRUE)
hrTesting  &lt;- subset(hr, split == FALSE)

dim(hrTraining)</code></pre>
<pre><code>## [1] 38013     9</code></pre>
<pre class="r"><code>dim(hrTesting)</code></pre>
<pre><code>## [1] 12671     9</code></pre>
<p>In this case, we will fit a model with all available variables.</p>
<pre class="r"><code>model &lt;- glm(formula = is_promoted ~ ., data = hrTraining, family = binomial(link = &#39;logit&#39;)) # with logit link function
summary(model)</code></pre>
<pre><code>## 
## Call:
## glm(formula = is_promoted ~ ., family = binomial(link = &quot;logit&quot;), 
##     data = hrTraining)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.8569  -0.4303  -0.2757  -0.1886   3.0463  
## 
## Coefficients:
##                       Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)          -6.637956   0.174657 -38.006  &lt; 2e-16 ***
## genderM              -0.089907   0.042309  -2.125 0.033586 *  
## no_of_courses        -0.197242   0.039195  -5.032 4.84e-07 ***
## age                  -0.012762   0.003497  -3.649 0.000263 ***
## previous_year_rating  0.331555   0.018941  17.505  &lt; 2e-16 ***
## length_of_service     0.025744   0.006221   4.138 3.50e-05 ***
## KPIs_met_greater_801  1.230945   0.043735  28.146  &lt; 2e-16 ***
## awards_won1           1.953581   0.078395  24.920  &lt; 2e-16 ***
## avg_training_score    0.043654   0.001476  29.573  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 22185  on 38012  degrees of freedom
## Residual deviance: 18482  on 38004  degrees of freedom
## AIC: 18500
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Now, we can use our fitted model to do predictions for <code>training</code> data set. Our objective here is to find a reasonable value for the threshold (<span class="math inline">\(\theta_0\)</span>).</p>
<pre class="r"><code>predictTraining &lt;- predict(model, type = &#39;response&#39;)
summary(predictTraining)</code></pre>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 0.002474 0.023561 0.048029 0.085418 0.107864 0.887217</code></pre>
<pre class="r"><code>tapply(predictTraining, hrTraining$is_promoted, mean)</code></pre>
<pre><code>##          0          1 
## 0.07504518 0.19648269</code></pre>
<p>These results show that for the true <code>is_promoted = 1</code> the average predicted probability is <span class="math inline">\(0.19\)</span>, while for the true <code>is_promoted = 0</code> the average predicted probability is <span class="math inline">\(0.08\)</span>. In this case, we want to choose a threshold <span class="math inline">\(\theta_0\)</span>, such that the prediction error (according to the above definitions) is as small as possible.</p>
<p>So, let’s see the effect of different thresholds on the sensitivity and specificity of the classifier.</p>
<pre class="r"><code># threshold = 0.75
(tb1 &lt;- table(hrTraining$is_promoted, predictTraining &gt; 0.75))</code></pre>
<pre><code>##    
##     FALSE  TRUE
##   0 34750    16
##   1  3164    83</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity: &#39;, round(tb1[2, 2] / (tb1[2, 2] + tb1[2, 1]), 3), sep = &#39;&#39;))</code></pre>
<pre><code>## [1] &quot;Sensitivity: 0.026&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity: &#39;, round(tb1[1, 1] / (tb1[1, 1] + tb1[1, 2]), 3), sep = &#39;&#39;))</code></pre>
<pre><code>## [1] &quot;Specificity: 1&quot;</code></pre>
<pre class="r"><code># threshold = 0.50
(tb2 &lt;- table(hrTraining$is_promoted, predictTraining &gt; 0.50))</code></pre>
<pre><code>##    
##     FALSE  TRUE
##   0 34622   144
##   1  3026   221</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity: &#39;, round(tb2[2, 2] / (tb2[2, 2] + tb2[2, 1]), 3), sep = &#39;&#39;))</code></pre>
<pre><code>## [1] &quot;Sensitivity: 0.068&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity: &#39;, round(tb2[1, 1] / (tb2[1, 1] + tb2[1, 2]), 3), sep = &#39;&#39;))</code></pre>
<pre><code>## [1] &quot;Specificity: 0.996&quot;</code></pre>
<pre class="r"><code># threshold = 0.25
(tb3 &lt;- table(hrTraining$is_promoted, predictTraining &gt; 0.25))</code></pre>
<pre><code>##    
##     FALSE  TRUE
##   0 32955  1811
##   1  2390   857</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity: &#39;, round(tb3[2, 2] / (tb3[2, 2] + tb3[2, 1]), 3), sep = &#39;&#39;))</code></pre>
<pre><code>## [1] &quot;Sensitivity: 0.264&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity: &#39;, round(tb3[1, 1] / (tb3[1, 1] + tb3[1, 2]), 3), sep = &#39;&#39;))</code></pre>
<pre><code>## [1] &quot;Specificity: 0.948&quot;</code></pre>
<p>How can we interpret these results?</p>
<p>Actually, we can see that by increasing the threshold the sensitivity decreases while specificity increases. Alternatively, the contrary happens when we decrease the threshold.</p>
<p>However, instead of testing these values manually, we will plot the Receiver Operating Characteristic (ROC) curve using the <code>prediction()</code> and <code>performance()</code> functions from the <code>ROCR</code> package.</p>
<pre class="r"><code>library(&#39;ROCR&#39;)

# First parameter is the vector of predicted probabilities, and
# second parameter is the vector of true values.
ROCRpred &lt;- prediction(predictTraining, hrTraining$is_promoted) 

# Compute the &#39;true positive rate&#39; and &#39;false positive rate&#39; for
# different values of threshold.
RPCRperf &lt;- performance(ROCRpred, &#39;tpr&#39;, &#39;fpr&#39;)

plot(RPCRperf, colorize = TRUE, print.cutoffs.at = c(0, 0.05, 0.1, 0.5, 1.0))</code></pre>
<p><img src="case_study_07_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>From the above plot, notice that the <code>sensitivity</code> is shown in the <code>y</code>-axis, and <code>1 - specificity</code> is shown in the <code>x</code>-axis. The curve always start at <span class="math inline">\((0, 0)\)</span> and always ends at <span class="math inline">\((1, 1)\)</span>. At <span class="math inline">\((0, 0)\)</span>, we will not get any false positive points, but we will not identify people who truly deserved to be promoted. On the other hand, at the endpoint we identify all people who deserved to be promoted, but the false positive rate is <span class="math inline">\(1\)</span>. Therefore, we want something in the middle (which depends on the problem).</p>
</div>
<div id="predicting-unknown-values" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Predicting unknown values</h1>
<p>For a threshold of <span class="math inline">\(0.1\)</span> (meaning that I expect to promote approximately 60% of people who deserve it, and I am willing to promote 20% of people who do not deserve it), I have the following results for the <code>testing</code> data set.</p>
<pre class="r"><code>predictTesting &lt;- predict(model, type = &#39;response&#39;, newdata = hrTesting)
(tb &lt;- table(hrTesting$is_promoted, predictTesting &gt;= 0.1))</code></pre>
<pre><code>##    
##     FALSE TRUE
##   0  8855 2734
##   1   376  706</code></pre>
<pre class="r"><code>print(paste(&#39;Accuracy: &#39;, round((sum(tb[, 1]) /sum(tb)), 3), sep = &#39;&#39;))</code></pre>
<pre><code>## [1] &quot;Accuracy: 0.729&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Sensitivity: &#39;, round(tb[2, 2] / (tb[2, 2] + tb[2, 1]), 3), sep = &#39;&#39;))</code></pre>
<pre><code>## [1] &quot;Sensitivity: 0.652&quot;</code></pre>
<pre class="r"><code>print(paste(&#39;Specificity: &#39;, round(tb[1, 1] / (tb[1, 1] + tb[1, 2]), 3), sep = &#39;&#39;))</code></pre>
<pre><code>## [1] &quot;Specificity: 0.764&quot;</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
