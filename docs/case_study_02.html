<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="André Victor Ribeiro Amaral" />


<title>Case Study 01</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Exercises in Linear Models</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="case_study_01.html">Case Study 01</a>
</li>
<li>
  <a href="case_study_02.html">Case Study 02</a>
</li>
<li>
  <a href="case_study_03.html">Case Study 03</a>
</li>
<li>
  <a href="case_study_04.html">Case Study 04</a>
</li>
<li>
  <a href="case_study_05.html">Case Study 05</a>
</li>
<li>
  <a href="case_study_06.html">Case Study 06</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://avramaral.github.io/">
    <span class="fa fa-globe"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Case Study 01</h1>
<h4 class="author">André Victor Ribeiro Amaral</h4>

</div>


<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>For this problem, we will study how the amount of carbon fiber and sand additions affect the hardness of a certain material. You can download the <code>.csv</code> file <a href="./datasets/hardness.csv">here</a>.</p>
<p>This data set contains following the variables:</p>
<ol style="list-style-type: decimal">
<li><code>sand</code> (multi-valued discrete)</li>
<li><code>carbon</code> (multi-valued discrete)</li>
<li><code>hardness</code> (continuous)</li>
</ol>
</div>
<div id="exploring-the-data-set" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Exploring the data set</h1>
<p>In order to explore the data set and perform initial analyses, we have to read it (with <code>R</code>) first. Provided that the <code>.csv</code> file is saved within the <code>datasets/</code> folder, one can read the file in the following way.</p>
<pre class="r"><code>col.names &lt;- c(&#39;sand&#39;, &#39;carbon&#39;, &#39;hardness&#39;)
hardness &lt;- read.csv(file = &#39;datasets/hardness.csv&#39;, header = FALSE, sep = &#39;,&#39;, col.names = col.names)
head(hardness, 5)</code></pre>
<pre><code>##   sand carbon hardness
## 1    0      0       61
## 2    0      0       63
## 3   15      0       67
## 4   15      0       69
## 5   30      0       65</code></pre>
<p>Now, let’s see a summary of our data.</p>
<pre class="r"><code>summary(hardness)</code></pre>
<pre><code>##       sand        carbon        hardness    
##  Min.   : 0   Min.   :0.00   Min.   :61.00  
##  1st Qu.: 0   1st Qu.:0.00   1st Qu.:67.50  
##  Median :15   Median :0.25   Median :69.00  
##  Mean   :15   Mean   :0.25   Mean   :69.61  
##  3rd Qu.:30   3rd Qu.:0.50   3rd Qu.:74.00  
##  Max.   :30   Max.   :0.50   Max.   :74.00</code></pre>
<p>As one can see from the above table, the multi-valued discrete attributes are being interpreted as numeric; however, we should set them as factor. For changing them, we can do the following</p>
<pre class="r"><code>hardness$sand &lt;- factor(hardness$sand, levels = c(0, 15, 30), labels = c(&#39;lowS&#39;, &#39;medS&#39;, &#39;highS&#39;))
hardness$carbon &lt;- factor(hardness$carbon, levels = c(0.00, 0.25, 0.50), labels = c(&#39;lowC&#39;, &#39;medC&#39;, &#39;highC&#39;))
summary(hardness)</code></pre>
<pre><code>##     sand     carbon     hardness    
##  lowS :6   lowC :6   Min.   :61.00  
##  medS :6   medC :6   1st Qu.:67.50  
##  highS:6   highC:6   Median :69.00  
##                      Mean   :69.61  
##                      3rd Qu.:74.00  
##                      Max.   :74.00</code></pre>
<p>Once we have the data, we can do a few plots that might help us understanding our problem. We can start by doing two different boxplots for the two categorical variables.</p>
<pre class="r"><code>boxplot(hardness ~ sand, data = hardness)</code></pre>
<p><img src="case_study_02_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>boxplot(hardness ~ carbon, data = hardness)</code></pre>
<p><img src="case_study_02_files/figure-html/unnamed-chunk-4-2.png" width="672" /> From both plots, it seems like there is a difference in one of the treatments (low doses for both sand and carbon) regarding the hardness of the material. However, we should only analyse the two factors separately if we can conclude that there is no interaction between them, meaning that there is no partial effect of one factor over the other. To see this, let’s use the <code>interaction.plot()</code> function to explore the possible interactions between the factors.</p>
<pre class="r"><code>interaction.plot(x.factor = hardness$sand, trace.factor = hardness$carbon, response = hardness$hardness)</code></pre>
<p><img src="case_study_02_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>interaction.plot(x.factor = hardness$carbon, trace.factor = hardness$sand, response = hardness$hardness)</code></pre>
<p><img src="case_study_02_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<p>From the both plots above, the interactions (if any) do not seem to be important (since the lines are, more or less, parallel). As an important side note, if there is <strong>no</strong> interaction, the main effects (if significant) will tell us if there is variation among the levels of the factor in question; however, if modeled with interaction, the main effects may be difficult to be correctly explored and should be avoided. In this case, one may simply consider all pairs of levels as separate treatments.</p>
</div>
<div id="fitting-a-model" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Fitting a model</h1>
<p>So let’s start by fitting our complete model.</p>
<pre class="r"><code>model &lt;- lm(formula = hardness ~ sand * carbon, data = hardness)
anova(model)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: hardness
##             Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
## sand         2 106.778  53.389  6.5374 0.01764 *
## carbon       2  87.111  43.556  5.3333 0.02967 *
## sand:carbon  4   8.889   2.222  0.2721 0.88870  
## Residuals    9  73.500   8.167                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>As we can see from the above table (and p-values), we <strong>reject</strong> the hypothesis “sand have no significant effect on hardness”, we reject the hypothesis “carbon have no significant effect on hardness”, as we <strong>fail to reject</strong> the hypothesis “sand and carbon interaction have no significant on hardness”. Thus, we can fit the following simplified model</p>
<pre class="r"><code>model2 &lt;- lm(formula = hardness ~ sand + carbon, data = hardness)
anova(model2)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: hardness
##           Df  Sum Sq Mean Sq F value   Pr(&gt;F)   
## sand       2 106.778  53.389  8.4241 0.004505 **
## carbon     2  87.111  43.556  6.8726 0.009195 **
## Residuals 13  82.389   6.338                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Now, as <a href="./case_study_01.html">before</a>, we can compute the estimated means and effects for sand and carbon from <code>hardness ~ sand + carbon</code>.</p>
<pre class="r"><code>modAOV &lt;- aov(formula = hardness ~ sand + carbon, data = hardness)
model.tables(modAOV, &#39;means&#39;)</code></pre>
<pre><code>## Tables of means
## Grand mean
##          
## 69.61111 
## 
##  sand 
## sand
##  lowS  medS highS 
## 66.33 70.33 72.17 
## 
##  carbon 
## carbon
##  lowC  medC highC 
## 66.50 71.17 71.17</code></pre>
<pre class="r"><code># Effects
model.tables(modAOV)</code></pre>
<pre><code>## Tables of effects
## 
##  sand 
## sand
##   lowS   medS  highS 
## -3.278  0.722  2.556 
## 
##  carbon 
## carbon
##    lowC    medC   highC 
## -3.1111  1.5556  1.5556</code></pre>
<p>Next, let’s do a residual analysis, so that we can make sure that our assumptions hold. We will plot the “Residuals vs. Fitted” and “Normal Q-Q” graphs, and conduct the appropriate tests, namely, <code>ncvTest()</code> (notice it is not the same as <code>leveneTest()</code>) and <code>shapiro.test()</code> (for <code>resid()</code>), for the equal variance and normally distributed residuals assumptions, respectively.</p>
<pre class="r"><code>plot(model2, which = c(1, 2))</code></pre>
<p><img src="case_study_02_files/figure-html/unnamed-chunk-9-1.png" width="672" /><img src="case_study_02_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<pre class="r"><code>library(&#39;car&#39;)
ncvTest(model2)</code></pre>
<pre><code>## Non-constant Variance Score Test 
## Variance formula: ~ fitted.values 
## Chisquare = 0.000267911, Df = 1, p = 0.98694</code></pre>
<pre class="r"><code>shapiro.test(resid(model2))</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  resid(model2)
## W = 0.96901, p-value = 0.779</code></pre>
<p>As the p-values are large for both tests, the assumptions seem to hold. Also, the plots allow us to conclude the same. Therefore, <code>model2</code> might correctly model our problem.</p>
<p>Also, as <a href="./case_study_01.html">before</a>, we can also do a pairwise analysis.</p>
<pre class="r"><code>(modTuk &lt;- TukeyHSD(modAOV))</code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = hardness ~ sand + carbon, data = hardness)
## 
## $sand
##                diff        lwr      upr     p adj
## medS-lowS  4.000000  0.1622397 7.837760 0.0408237
## highS-lowS 5.833333  1.9955730 9.671094 0.0039170
## highS-medS 1.833333 -2.0044270 5.671094 0.4403222
## 
## $carbon
##                diff        lwr      upr     p adj
## medC-lowC  4.666667  0.8289063 8.504427 0.0174826
## highC-lowC 4.666667  0.8289063 8.504427 0.0174826
## highC-medC 0.000000 -3.8377603 3.837760 1.0000000</code></pre>
<pre class="r"><code>plot(modTuk)</code></pre>
<p><img src="case_study_02_files/figure-html/unnamed-chunk-10-1.png" width="672" /><img src="case_study_02_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
</div>
<div id="predicting-unknown-values" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Predicting unknown values</h1>
<p>Finally, the predicted values for each combination of level of <code>sand</code> and <code>carbon</code> can be computed using the <code>predict()</code> function.</p>
<pre class="r"><code>(newdata &lt;- data.frame(sand = factor(rep(c(&#39;lowS&#39;, &#39;medS&#39;, &#39;highS&#39;), each = 3)), carbon = factor(rep(c(&#39;lowC&#39;, &#39;medC&#39;, &#39;highC&#39;), times = 3))))</code></pre>
<pre><code>##    sand carbon
## 1  lowS   lowC
## 2  lowS   medC
## 3  lowS  highC
## 4  medS   lowC
## 5  medS   medC
## 6  medS  highC
## 7 highS   lowC
## 8 highS   medC
## 9 highS  highC</code></pre>
<pre class="r"><code>newdata$predict &lt;- predict(model2, newdata = newdata)
newdata</code></pre>
<pre><code>##    sand carbon  predict
## 1  lowS   lowC 63.22222
## 2  lowS   medC 67.88889
## 3  lowS  highC 67.88889
## 4  medS   lowC 67.22222
## 5  medS   medC 71.88889
## 6  medS  highC 71.88889
## 7 highS   lowC 69.05556
## 8 highS   medC 73.72222
## 9 highS  highC 73.72222</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
